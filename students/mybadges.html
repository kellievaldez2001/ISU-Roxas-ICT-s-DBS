<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Badges | ISU-Roxas ICT Digital Badge System</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
  <div class="app-shell">
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container">
        <a class="navbar-brand" href="index.html"><span>ISU-Roxas DBS</span></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="mainNav">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="courses.html">Courses</a></li>
            <li class="nav-item"><a class="nav-link" href="mybadges.html">My Badges</a></li>
          </ul>
          <div class="nav-auth d-flex align-items-center gap-2 mt-3 mt-lg-0 pe-lg-1">
            <div class="dropdown">
              <button class="btn btn-outline-light btn-sm dropdown-toggle" type="button" id="userMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                <span id="userMenuLabel">Account</span>
              </button>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenuButton">
                <li><a class="dropdown-item text-danger" href="#" id="logoutLink">Log out</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <main class="app-main">
      <div class="container">
        <div class="page-header">
          <div>
            <h1 class="page-title">My Badges</h1>
            <p class="page-subtitle">Badges you've earned from completing ISU-Roxas DBS courses.</p>
          </div>
        </div>

        <div id="badgePageAlert"></div>

        <div class="alert alert-info d-none" id="badgeStatus" role="status">
          Keep learning to unlock your first badge.
        </div>

        <div class="row g-4" id="badgeList"></div>
      </div>
    </main>

    <div class="modal fade" id="qrModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title h5">Badge QR Code</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center">
            <img id="qrImage" src="" alt="Badge QR Code" class="img-fluid" style="max-width: 220px;" />
            <p id="qrMeta" class="small text-muted mt-3"></p>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="certificateModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" style="width: 900px; height: 693px; max-width: 98vw; max-height: 98vh;">
        <div class="modal-content" style="height: 100%;">
          <div class="modal-header">
            <h2 class="modal-title h5">Certificate of Completion</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body" style="height: calc(100% - 56px); display: flex; flex-direction: column; align-items: center; justify-content: center;">
            <div class="certificate-template" style="border: 3px solid #28a745; padding: 40px; background: linear-gradient(135deg, #ffffff 0%, #f0fff0 25%, #e6ffe6 50%, #f0fff0 75%, #ffffff 100%); font-family: 'Courier New', monospace; position: relative; width: 100%; height: 100%; box-sizing: border-box; display: flex; flex-direction: column; justify-content: center; align-items: center; box-shadow: 0 0 20px rgba(40,167,69,0.2);">
              <!-- Modern tech design elements -->
              <div style="position: absolute; top: 30px; left: 30px; width: 25px; height: 8px; background: linear-gradient(90deg, #007bff, #28a745); border-radius: 4px; opacity: 0.9;"></div>
              <div style="position: absolute; top: 45px; left: 30px; width: 15px; height: 8px; background: #ffc107; border-radius: 4px; opacity: 0.9;"></div>
              <div style="position: absolute; top: 30px; right: 30px; width: 8px; height: 25px; background: #dc3545; border-radius: 4px; opacity: 0.9;"></div>
              <div style="position: absolute; top: 45px; right: 20px; width: 8px; height: 15px; background: #6f42c1; border-radius: 4px; opacity: 0.9;"></div>
              <div style="position: absolute; bottom: 30px; left: 30px; width: 20px; height: 8px; background: #28a745; border-radius: 4px; opacity: 0.9;"></div>
              <div style="position: absolute; bottom: 45px; left: 30px; width: 12px; height: 8px; background: #007bff; border-radius: 4px; opacity: 0.9;"></div>
              <div style="position: absolute; bottom: 30px; right: 30px; width: 8px; height: 20px; background: #ffc107; border-radius: 4px; opacity: 0.9;"></div>
              <div style="position: absolute; bottom: 45px; right: 20px; width: 8px; height: 12px; background: #dc3545; border-radius: 4px; opacity: 0.9;"></div>
              
              <!-- Circuit pattern -->
              <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.05; background-image: 
                linear-gradient(90deg, #28a745 1px, transparent 1px),
                linear-gradient(180deg, #28a745 1px, transparent 1px); background-size: 20px 20px;"></div>
              
              <div style="position: absolute; top: 20px; right: 20px; font-size: 12px; font-weight: bold; color: #28a745;">ISU-Roxas ICT Digital Badge System</div>
              <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 85%; height: 85%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; z-index: 2;">
                <h1 style="font-size: 42px; margin-bottom: 25px; color: #28a745; text-shadow: 1px 1px 2px rgba(40,167,69,0.2); z-index: 1; font-family: 'Arial', sans-serif;">CERTIFICATE OF COMPLETION</h1>
                <h2 id="certificateStudentName" style="font-size: 28px; margin-bottom: 15px; color: #007bff; z-index: 1; font-family: 'Arial', sans-serif;"></h2>
                <p id="certificateDescription" style="font-size: 18px; margin-bottom: 15px; color: #495057; z-index: 1; font-family: 'Arial', sans-serif;"></p>
                <p id="certificateDate" style="font-size: 16px; margin-bottom: 8px; color: #6c757d; z-index: 1; font-family: 'Courier New', monospace;">Date: <span id="dateValue"></span></p>
                <p id="certificatePublisher" style="font-size: 16px; margin-bottom: 0; color: #6c757d; z-index: 1; font-family: 'Courier New', monospace;">Issued by: <span id="publisherValue"></span></p>
                <div style="position: absolute; bottom: 12%; left: 50%; transform: translateX(-50%); width: 200px; height: 2px; background: linear-gradient(to right, #28a745, #007bff, #ffc107); z-index: 1;"></div>
                <div style="position: absolute; bottom: 7%; left: 50%; transform: translateX(-50%); font-size: 12px; color: #28a745; font-family: 'Courier New', monospace; z-index: 1;">Digital Signature Verified</div>
              </div>
              <img id="certificateQrImage" src="" alt="Certificate QR Code" style="position: absolute; bottom: 20px; left: 20px; width: 80px; z-index: 3; border: 2px solid #28a745; border-radius: 5px;" />
            </div>
            <button id="downloadCertificateBtn" class="btn btn-primary mt-3">Download Certificate</button>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <div class="container text-center">
        <small>&copy; <span id="currentYear"></span> ISU-Roxas ICT Department</small>
      </div>
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/js/common.js"></script>
  <script src="../assets/js/config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.1/dist/umd/supabase.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    window.SUPABASE_URL = window.SUPABASE_URL || "https://zrjoqppbowbiohhkgexx.supabase.co";
    window.SUPABASE_ANON_KEY = window.SUPABASE_ANON_KEY || "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpyam9xcHBib3diaW9oaGtnZXh4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4MTcyNzUsImV4cCI6MjA3NzM5MzI3NX0.NVQGZO4dfBzN-vAB2Jgr4qcvJsWvWSMbZ9Sd8cQ6Cbo";
  </script>
  <script src="../assets/js/supabaseClient.js"></script>
  <script src="../assets/js/my_badges_student.js"></script>
</body>
</html>
