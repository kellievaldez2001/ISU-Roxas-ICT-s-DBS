<div class="modal fade" id="moduleLessonsModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <div>
          <h2 class="modal-title h5 mb-0">Add Module &amp; Lessons</h2>
          <p class="small text-muted mb-0" id="moduleLessonsCourseTitle"></p>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="moduleLessonsForm" class="needs-validation" novalidate>
        <div class="modal-body">
          <div id="moduleLessonsFormAlert" class="alert d-none" role="alert"></div>

          <div class="row g-3 align-items-end">
            <div class="col-12 col-md-6">
              <label for="moduleLessonsTitle" class="form-label">Module title</label>
              <input type="text" class="form-control" id="moduleLessonsTitle" placeholder="Module title" required>
              <div class="invalid-feedback">Module title is required.</div>
            </div>
            <div class="col-12 col-md-6">
              <label for="moduleLessonsCount" class="form-label">Number of lessons</label>
              <input type="number" class="form-control" id="moduleLessonsCount" min="0" value="0" required>
              <div class="invalid-feedback">Please specify how many lessons this module will contain.</div>
            </div>
          </div>

          <div class="mt-3">
            <label for="moduleLessonsDescription" class="form-label">Module description <span class="text-muted">(optional)</span></label>
            <textarea id="moduleLessonsDescription" class="form-control" rows="2" placeholder="Provide a short description"></textarea>
          </div>

          <hr class="my-4">

          <div class="d-flex justify-content-between align-items-center mb-2">
            <h3 class="h6 mb-0">Lesson details</h3>
            <p class="small text-muted mb-0">Lesson fields update automatically when you change the count above.</p>
          </div>

          <div id="moduleLessonsContainer" class="vstack gap-3"></div>
        </div>
        <div class="modal-footer modal-footer-fixed">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary" id="moduleLessonsSaveButton">Save module &amp; lessons</button>
        </div>
      </form>
    </div>
  </div>
</div>

<template id="moduleLessonTemplate">
  <section class="card shadow-sm border-0 lesson-block">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-start mb-3">
        <div>
          <p class="badge bg-success-subtle text-success lesson-index mb-1">Lesson <span data-role="lesson-number">1</span></p>
          <h4 class="h6 mb-0">Lesson details</h4>
        </div>
        <button type="button" class="btn btn-link text-danger p-0 lesson-remove" data-role="remove-lesson" aria-label="Remove lesson">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="row g-3">
        <div class="col-12 col-md-6">
          <label class="form-label">Lesson title</label>
          <input type="text" class="form-control" data-role="lesson-title" placeholder="Lesson title" required>
          <div class="invalid-feedback">Lesson title is required.</div>
        </div>
        <div class="col-12 col-md-6">
          <label class="form-label">Lesson Overview <span class="text-muted">(optional)</span></label>
          <input type="text" class="form-control" data-role="lesson-index" placeholder="Add a short overview of this lesson">
        </div>
        <div class="col-12">
          <label class="form-label">Discussion / lesson content</label>
          <textarea class="form-control" rows="4" data-role="lesson-content" placeholder="Add discussion points, objectives, or resources" required></textarea>
          <div class="invalid-feedback">Please provide lesson content.</div>
        </div>
      </div>

      <div class="d-flex justify-content-end mt-3">
        <button type="button" class="btn btn-outline-success btn-sm" data-role="lesson-add-quiz">Add quiz</button>
      </div>

      <div class="card bg-body-tertiary border-0 mt-3 d-none" data-role="lesson-quiz-container">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <div>
              <p class="badge bg-primary-subtle text-primary mb-1">Quiz Items</p>
              <h5 class="h6 mb-1">Lesson quiz</h5>
              <p class="text-muted small mb-0">Provide optional assessment items for this lesson.</p>
            </div>
            <button type="button" class="btn btn-link text-danger p-0" data-role="lesson-remove-quiz">Remove</button>
          </div>

          <div class="row align-items-end g-3 mb-3">
            <div class="col-12 col-md-4">
              <label class="form-label">Number of items</label>
              <input type="number" class="form-control" min="1" value="1" data-role="lesson-quiz-count">
            </div>
            <div class="col">
              <p class="small text-muted mb-0">Adjust to add more multiple-choice questions for this lesson.</p>
            </div>
          </div>

          <div class="vstack gap-3" data-role="lesson-quiz-questions"></div>

          <template data-role="lesson-quiz-question-template">
            <div class="lesson-quiz-question border rounded p-3" data-role="lesson-quiz-question">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h6 class="mb-0">Item <span data-role="quiz-item-number">1</span></h6>
              </div>

              <div class="mb-3">
                <label class="form-label">Question</label>
                <textarea class="form-control" rows="3" data-role="quiz-question" placeholder="Enter the quiz question"></textarea>
              </div>

              <div class="row g-2 mb-3">
                <div class="col-12 col-md-6">
                  <label class="form-label">Option A</label>
                  <input type="text" class="form-control" data-role="quiz-option" data-option="a" placeholder="Option A">
                </div>
                <div class="col-12 col-md-6">
                  <label class="form-label">Option B</label>
                  <input type="text" class="form-control" data-role="quiz-option" data-option="b" placeholder="Option B">
                </div>
                <div class="col-12 col-md-6">
                  <label class="form-label">Option C</label>
                  <input type="text" class="form-control" data-role="quiz-option" data-option="c" placeholder="Option C">
                </div>
                <div class="col-12 col-md-6">
                  <label class="form-label">Option D</label>
                  <input type="text" class="form-control" data-role="quiz-option" data-option="d" placeholder="Option D">
                </div>
              </div>

              <div>
                <label class="form-label">Correct answer</label>
                <select class="form-select" data-role="quiz-answer">
                  <option value="a">Option A</option>
                  <option value="b">Option B</option>
                  <option value="c">Option C</option>
                  <option value="d">Option D</option>
                </select>
              </div>

              <div class="mt-3">
                <label class="form-label">Explanation <span class="text-muted">(optional)</span></label>
                <textarea class="form-control" rows="2" data-role="quiz-explanation" placeholder="Provide additional context for the correct answer"></textarea>
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>
  </section>
</template>
